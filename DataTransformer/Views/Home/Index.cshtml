@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<p>Here, you can <strong>transform your data.</strong> &nbsp; Choose your file or play with the sample below.</p>
    
@Html.Partial("_RawDataHdr")
Products Sample.xlsx <br />
<table class='table table-striped table-bordered tblData' id="tblRaw">
    <thead>
        <tr>
            <th class="NoTh">#</th><th>Region</th><th>Category</th><th>Item Name</th><th>Quantity</th><th>Sale Price</th><th>Custom Column</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="NoTh">1</td><td>East</td><td>Office Supplies</td><td>Printer paper</td><td>350</td><td>14.15</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">2</td><td>Central</td><td>Technology</td><td>Desktop computer</td><td>12</td><td>543.99</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">3</td><td>Central</td><td>Office Supplies</td><td>Punched paper</td><td>15</td><td>57.99</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">4</td><td>West</td><td>Furniture</td><td>Sofa bed</td><td>4</td><td>4050</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">5</td><td>East</td><td>Office Supplies</td><td>Greeting cards</td><td>500</td><td>7.99</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">6</td><td>Central</td><td>Office Supplies</td><td>Business cards</td><td>650</td><td>16.5</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">7</td><td>West</td><td>Technology</td><td>Bluetooth keyboard</td><td>975</td><td>29.99</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">8</td><td>East</td><td>Furniture</td><td>Mattress</td><td>200</td><td>1370</td><td></td>
        </tr>
        <tr>
            <td class="NoTh">9</td><td>East</td><td>Technology</td><td>Wireless mouse</td><td>1250</td><td>79.99</td><td></td>
        </tr>
    </tbody>
</table>

<div class="row bg-info SectionHeader">
    <div class="col-sm-12" style="padding-left:0px;">
        <strong>Transformation Rules</strong>
    </div>
</div>
<form action="/Process/ApplyRules" method="post" id="frmRules">
    <input type="hidden" name="sessionId" value="0" />
    <input type="hidden" name="tmpFN" value="@Html.Raw(ViewBag.TempDownloadFileName)" />
    <table class="tblRules" id="tblRules" width="100%">
        <tbody>
            <tr id="tr0">
                <td class="Col1">
                    IF
                    <select name="colSource0">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name" selected>Item Name</option>
                        <option value="Quantity">Quantity</option>
                        <option value="Sale Price">Sale Price</option>
                        <option value="Custom Column">Custom Column</option>
                    </select>
                    <select name="op0">
                        <option value="0">Contains</option>
                        <option value="1">Starts With</option>
                        <option value="2">Ends With</option>
                        <option value="3">Is</option>
                        <option value="4">Is Greater Than</option>
                        <option value="5">Is Less Than</option>
                    </select>
                    <input type="text" class="txtIfValue" name="txtIfValue0" value="paper" />
                    THEN transform
                    <select name="colTarget0">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name">Item Name</option>
                        <option value="Quantity">Quantity</option>
                        <option value="Sale Price" selected>Sale Price</option>
                        <option value="Custom Column">Custom Column</option>
                    </select>
                    To
                </td>
                <td class="Col2">
                    <input type="text" name="txtTransfTo0" id="txtTransfTo0" value="([sale price]+0.50)" />
                </td>
            </tr>
            <tr id="tr1">
                <td class="Col1">
                    IF
                    <select name="colSource1">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name">Item Name</option>
                        <option value="Quantity" selected>Quantity</option>
                        <option value="Sale Price">Sale Price</option>
                        <option value="Custom Column">Custom Column</option>
                    </select>
                    <select name="op1">
                        <option value="0">Contains</option>
                        <option value="1">Starts With</option>
                        <option value="2">Ends With</option>
                        <option value="3">Is</option>
                        <option value="4">Is Greater Than</option>
                        <option value="5" selected>Is Less Than</option>
                    </select>
                    <input type="text" class="txtIfValue" name="txtIfValue1" value="10" />
                    THEN transform
                    <select name="colTarget1">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name" selected>Item Name</option>
                        <option value="Quantity">Quantity</option>
                        <option value="Sale Price">Sale Price</option>
                        <option value="Custom Column">Custom Column</option>
                    </select>
                    To
                </td>
                <td class="Col2">
                    <input type="text" name="txtTransfTo1" id="txtTransfTo1" value="[item name] (Only [quantity] left)" />
                </td>
            </tr>
            <tr id="tr2">
                <td class="Col1">
                    IF
                    <select name="colSource2">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name">Item Name</option>
                        <option value="Quantity">Quantity</option>
                        <option value="Sale Price" selected>Sale Price</option>
                        <option value="Custom Column">Custom Column</option>
                    </select>
                    <select name="op2">
                        <option value="0">Contains</option>
                        <option value="1">Starts With</option>
                        <option value="2">Ends With</option>
                        <option value="3">Is</option>
                        <option value="4" selected>Is Greater Than</option>
                        <option value="5">Is Less Than</option>
                    </select>
                    <input type="text" class="txtIfValue" name="txtIfValue2" value="0" />
                    THEN transform
                    <select name="colTarget2">
                        <option value="Region">Region</option>
                        <option value="Category">Category</option>
                        <option value="Item Name">Item Name</option>
                        <option value="Quantity">Quantity</option>
                        <option value="Sale Price">Sale Price</option>
                        <option value="Custom Column" selected>Custom Column</option>
                    </select>
                    To
                </td>
                <td class="Col2">
                    <input type="text" name="txtTransfTo2" id="txtTransfTo2" value="[region]-[category]-([quantity])" />
                </td>
            </tr>
            <tr id="tr3"></tr>
        </tbody>
    </table>
</form>
<div class="row" style="padding-top:4px;">
    <div class="col-sm-12">
        <div class="pull-right">
            <button class="btn btn-default btn-sm" id="btnAddRule">Add</button>
            <button class="btn btn-default btn-sm" id="btnRemoveRule">Remove</button>
            <button class="btn btn-primary btn-sm" id="btnApplyRules">Apply Rules</button>
        </div>
    </div>
</div>
<br />

<div class="row bg-success SectionHeader">
    <div class="col-sm-2" style="padding-left:0px;">
        <strong>Transformed Data</strong>
    </div>
    <div class="col-sm-10">
        <input type="button" value="Download" id="btnDownload" class="btn btn-default btn-sm" title="Download transformed data" />
        <input type="hidden" name="downFN" id="downFN" value="@Html.Raw(ViewBag.TempDownloadFilePath)" />
        <input type="hidden" name="downFNhome" id="downFNhome" value="@Html.Raw(ViewBag.TempDownloadFilePathHome)" />
    </div>
</div>

<table class='table table-striped table-bordered tblData' id="tblResult">
    <thead id="thResult">
        <tr>
            <th class="NoTh">#</th>
            <th>Region</th>
            <th>Category</th>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Sale Price</th>
            <th>Custom Column</th>
        </tr>
    </thead>
    <tbody id="tbResult">
        <tr>
            <td class="NoTh">1</td>
            <td>East</td>
            <td>Office Supplies</td>
            <td>Printer paper</td>
            <td>350</td>
            <td>14.65</td>
            <td>East-Office Supplies-(350)</td>
        </tr>
        <tr>
            <td class="NoTh">2</td>
            <td>Central</td>
            <td>Technology</td>
            <td>Desktop computer</td>
            <td>12</td>
            <td>543.99</td>
            <td>Central-Technology-(12)</td>
        </tr>
        <tr>
            <td class="NoTh">3</td>
            <td>Central</td>
            <td>Office Supplies</td>
            <td>Punched paper</td>
            <td>15</td>
            <td>57.99</td>
            <td>Central-Office Supplies-(15)</td>
        </tr>
        <tr>
            <td class="NoTh">4</td>
            <td>West</td>
            <td>Furniture</td>
            <td>Sofa bed (only 4 left)</td>
            <td>4</td>
            <td>4050</td>
            <td>West-Furniture-(4)</td>
        </tr>
        <tr>
            <td class="NoTh">5</td>
            <td>East</td>
            <td>Office Supplies</td>
            <td>Greeting cards</td>
            <td>500</td>
            <td>7.99</td>
            <td>East-Office Supplies-(500)</td>
        </tr>
        <tr>
            <td class="NoTh">6</td>
            <td>Central</td>
            <td>Office Supplies</td>
            <td>Business cards</td>
            <td>650</td>
            <td>16.5</td>
            <td>Central-Office Supplies-(650)</td>
        </tr>
        <tr>
            <td class="NoTh">7</td>
            <td>West</td>
            <td>Technology</td>
            <td>Bluetooth keyboard</td>
            <td>975</td>
            <td>29.99</td>
            <td>West-Technology-(975)</td>
        </tr>
        <tr>
            <td class="NoTh">8</td>
            <td>East</td>
            <td>Furniture</td>
            <td>Mattress</td>
            <td>200</td>
            <td>1370</td>
            <td>East-Furniture-(200)</td>
        </tr>
        <tr>
            <td class="NoTh">9</td>
            <td>East</td>
            <td>Technology</td>
            <td>Wireless mouse</td>
            <td>1250</td>
            <td>79.99</td>
            <td>East-Technology-(1250)</td>
        </tr>
    </tbody>
</table>

<script src="~/js/homeindex.js"></script>
